<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_security_acl">
    <sys_security_acl action="INSERT_OR_UPDATE">
        <active>true</active>
        <admin_overrides>false</admin_overrides>
        <advanced>true</advanced>
        <condition/>
        <description>Default access control on x_153465_discovert_tasker_schedule</description>
        <name>x_153465_discovert_tasker_schedule</name>
        <operation display_value="delete">delete</operation>
        <script><![CDATA[try{ 
	var createdBy = current.getValue("sys_created_by");
	var processTemplateID = current.getValue("tasker_process");
	var processTemplateQuery = [];
	processTemplateQuery.push({"sys_id":processTemplateID});
	var processTemplateTableName = "x_153465_discovert_discover_routing_template";
	var taskerCommonScripts = new TaskerCommonScriptingMethods();
	var currentUserId = gs.getUser().getID();
	var currentUserName = gs.getUser().getName();
	var processOu = "";
	var checkTemplateCreator = [];
	var processTemplateCreatorCheck = false;
	if(processTemplateID) {
		checkTemplateCreator = taskerCommonScripts.queryRelatedShort(processTemplateTableName, processTemplateQuery, function(record) {
			//while we're checking, ensure that we get process ou
			try {
				processOu = record.process_ou;
				if(record.sys_created_by == currentUserName) {
					return true;
				}
			} catch(v){
				gs.warn(v);
			}
			
			return null;
		}, true);
	}
	if(currentUserName == createdBy) {
		answer = true;
	} else if(checkTemplateCreator.length > 0) {
		answer = true;
	} else if(taskerCommonScripts.checkUserForSingleRoleMatch(gs.getUser(), ["x_153465_discovert.tasker_process_template_admin"])) {
		answer = true;
	} else if(taskerCommonScripts.checkUserForSingleRoleMatch(gs.getUser(), ["x_153465_discovert.tasker_process_template_ou"])) {
		var userInfoScripts = new UserInfoScripts();
		if(processOu !== "" && userInfoScripts.IsUserInOU(processOu, currentUserId)) {
			answer = true;
		}
	} else {
		answer = false;
	}
}catch(e) {
	answer = false;
	gs.warn("ACCESS CONTROL - SCHEDULES: " + e + " at " + e.lineNumber);
}
]]></script>
        <sys_class_name>sys_security_acl</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-19 16:25:30</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_id>1836126bdb829f003a8d6be3ca961938</sys_id>
        <sys_mod_count>17</sys_mod_count>
        <sys_name>x_153465_discovert_tasker_schedule</sys_name>
        <sys_package display_value="Tasker" source="x_153465_discovert">c6b1162d4fc10300303dc3818110c7b1</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="Tasker">c6b1162d4fc10300303dc3818110c7b1</sys_scope>
        <sys_update_name>sys_security_acl_1836126bdb829f003a8d6be3ca961938</sys_update_name>
        <sys_updated_by>kbaton</sys_updated_by>
        <sys_updated_on>2019-02-28 18:04:40</sys_updated_on>
        <type display_value="record">record</type>
    </sys_security_acl>
</record_update>
