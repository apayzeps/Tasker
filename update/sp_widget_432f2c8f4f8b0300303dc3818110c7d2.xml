<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[function ($scope, spUtil) {
//------------------------------------------------------------------------------------------------------------------------
// WIDGET BASE: FIELDS
// COMPANY: DISCOVER TECHNOLOGIES
// CUSTOMIZED BY: KARINA TORRES
//------------------------------------------------------------------------------------------------------------------------		
	spUtil.recordWatch($scope, $scope.data.table, "sys_id=" + $scope.data.sys_id); 
	var onListClick = $scope.$on('$sp.list.click', refreshWidget);
	var onSaveUpdate = $scope.$on('sp.form.record.updated', refreshWidget);

	function refreshWidget() {
		$scope.server.update();
	}
}

]]></client_script>
        <controller_as>c</controller_as>
        <css>.options-btn {
    border:none;
    background-image:none;
    background-color:transparent;
    -webkit-box-shadow: none;
    -moz-box-shadow: none;
    box-shadow: none;
}

.glyphicon {
	padding-right: 5px;
}

.header-label {
    font-color: red;//#004475;
}

.icon-success {
    color: #37C1C3;
}

.icon-danger {
    color: #FF6B61;
}

.icon-warning {
    color: #F6C716;
}

.icon-primary {
    color: #2E3C54;
}


.icon-default {
    color: #808080;
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description>Show fields in the "Summary Card"</description>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id>discovertasker-summarycard</id>
        <internal>false</internal>
        <link/>
        <name>Tasker Summary Card</name>
        <option_schema>[&#13;
   {&#13;
      "name": "pickup_msg",&#13;
      "label": "Pickup message",&#13;
      "type": "string"&#13;
   }&#13;
]</option_schema>
        <public>false</public>
        <roles>x_153465_discovert.tasker_user</roles>
        <script><![CDATA[//------------------------------------------------------------------------------------------------------------------------
// COMPANY: DISCOVER TECHNOLOGIES
// CUSTOMIZED BY: KARINA TORRES
// WIDGET BASE: FIELDS
//------------------------------------------------------------------------------------------------------------------------
(function(){
	data.pickupMsg = gs.getMessage(options.pickup_msg);
	var gr = $sp.getRecord();
	if (gr == null)
		return;
	
	data.canRead = gr.canRead();
	if (!data.canRead) 
		return;

	var agent = "";
	var a = $sp.getField(gr, 'assigned_to');
	if (a != null)
		agent = a.display_value;

	var fields = $sp.getFields(gr, 'comments,parent,suggested_task,state,assigned_to,u_reviewer,suspense_date,tasker_type,primary_assignee,status,status_reason,progress_of_sub_tasks,child_route_template,decision,sys_created_on,originator,on_behalf_of,sys_updated_on,sys_updated_by');
	//if (gr.getValue("sys_mod_count") > 0)
	//	fields.push($sp.getField(gr, 'sys_updated_on'));

	if ($sp.getParameter("table") == "x_153465_discovert_route_task_instance") {
		if (gr.getValue('parent') != null) {

			var grParent = new GlideRecordSecure(($sp.getParameter("table")));
			grParent.get(gr.getValue('parent'));
			if(grParent.assigned_to != null) {
				 data.parent_assigned_to = grParent.getDisplayValue('assigned_to');
				 //fields.push($sp.getField(grParent, 'assigned_to'));
			}
		}
	}
	
	if (gr.getValue('state') == '3') {
		fields.push($sp.getField(gr, 'u_completed_on_time'));
	}
	if (gr.getValue('extension_requested') == '1') {
		fields.push($sp.getField(gr, 'extension_requested'));
	}
	if (gr.getValue('reassignment_requested') == '1') {
		fields.push($sp.getField(gr, 'reassignment_requested'));
	}
	data.title = gr.getValue('task_name');
	data.tableLabel = gr.getLabel();
	data.fields = fields;
	data.variables = $sp.getVariablesArray();
	data.agent = agent;
	data.agentPossible = gr.isValidField("assigned_to");
	data.table = gr.getTableName();
	data.sys_id = gr.getUniqueValue();
	//------------------------------------------------------ KTorres
	data.parent_sys_id = gr.getValue('parent');	
	var currentUser = gs.getUser().getID(); 
	//---------------------------------------------------------
})()

]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>kTorres</sys_created_by>
        <sys_created_on>2017-12-19 16:30:04</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_id>432f2c8f4f8b0300303dc3818110c7d2</sys_id>
        <sys_mod_count>456</sys_mod_count>
        <sys_name>Tasker Summary Card</sys_name>
        <sys_package display_value="Tasker" source="x_153465_discovert">c6b1162d4fc10300303dc3818110c7b1</sys_package>
        <sys_policy>protected</sys_policy>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="Tasker">c6b1162d4fc10300303dc3818110c7b1</sys_scope>
        <sys_update_name>sp_widget_432f2c8f4f8b0300303dc3818110c7d2</sys_update_name>
        <sys_updated_by>aalzyoud</sys_updated_by>
        <sys_updated_on>2019-03-20 19:01:51</sys_updated_on>
        <template><![CDATA[<div ng-if="data.canRead" class="panel b">
  <div class="panel-heading bg-primary">
    <div ng-init="spSearch.targetRequests()">
      <sp-c-link target="form" table="data.table" id="data.sys_id"/>
    </div>
    <span><h5>{{data.title}}</h5></span>
    <!--
    <span ng-if="data.agent" >
      ${Agent working on this {{data.tableLabel}}}:
      <div>{{data.agent}}</div>
    </span>
    <span ng-if="!data.agent && data.agentPossible" >${Your request has been submitted}</span>
    <span ng-if="!data.agentPossible">${{{data.tableLabel}} record details}</span>
	-->
  </div>

  <div class="panel-body">
    <div ng-if="data.fields.length > 0">
      <div class="row">
        <div class="col-md-6 col-sm-12 col-xs-6 m-b break-word" ng-repeat="field in data.fields" 
             ng-if="field.value && (field.type != 'decimal' || field.type == 'decimal' && field.value != 0) " ><!-- ng-if="field.value && (field.type != 'decimal' || field.type == 'decimal' && field.value != 0)" > -->
          <label class="m-n" style="color:#004475">{{field.label}}</label>
					<span ng-switch="field.type" style="color:#555555">
            <!--
						<div ng-switch-when="glide_date_time" title="{{field.display_value}}">
              <sn-time-ago timestamp="::field.value" />
            </div>
						-->

            <div ng-switch-when="reference" title="{{field.display_value}}">
              <span ng-switch="field.label">
                <div ng-switch-when="Parent" title="{{field.display_value}}">
                  <a ng-href="{{'?id=discovertasker_taskdetails&table=x_153465_discovert_route_task_instance&sys_id=' + data.parent_sys_id}}">{{field.display_value}}</a>
                </div>
                <div ng-switch-when="Assigned Member" title="{{field.display_value}}">
                  <span class="glyphicon glyphicon-user icon-default" aria-hidden="true"></span>&nbsp;{{field.display_value}}
                  	<!-- <label class="m-n ng-binding" style="color:#004475">Owner</label> -->
                  	<!-- <div ng-if="data.parent_assigned_to" ng-switch-default="" class="ng-binding ng-scope">{{data.parent_assigned_to}}</div> -->
                </div>
                <!--div ng-switch-when="Tasker Type" title="{{field.display_value}}">
                  <span class="label label-info pull-left">{{field.display_value}}</span><br>
                </div-->
                <div ng-switch-default>{{field.display_value}}</div>
              </span>
            </div>
            <div ng-switch-default>
              <div ng-switch="field.display_value">
                <div ng-switch-when="Critical"><span class="glyphicon glyphicon-flag icon-danger" aria-hidden="true"></span>{{field.display_value}}<!--i class="fa fa-circle-o fa-sm" aria-hidden="true"></i--></div>
                <div ng-switch-when="Warning"><span class="glyphicon glyphicon-flag icon-warning" aria-hidden="true"></span>{{field.display_value}}</div>
                <div ng-switch-when="Projected on time"><span class="glyphicon glyphicon-flag icon-success" aria-hidden="true"></span>{{field.display_value}}</div>
                <div ng-switch-when="true"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></div>
                <div ng-switch-when="false"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></div>
                <div ng-switch-default>{{field.display_value}}</div>
              </div>
            </div>
          </span>
          

<!--
        <span ng-switch="field.type">
            <div ng-switch-when="glide_date_time" title="{{field.display_value}}">
              <sn-time-ago timestamp="::field.value" />
            </div>
            <div ng-switch-when="reference" title="{{field.display_value}}">
              <a href="">{{field.display_value}}</a>
            </div>
            <div ng-switch-default>{{field.display_value}}</div>
          </span>
-->
          
        <!--/div><a href="skype:KTorres?call">Call </a--> <!--a href="tel:+14432813894">Call 443.281.3894</a-->
        
      </div>
     <!-- <div ng-if="data.canrequest_reassignment == 'yes'">
        <a class="btn btn-warning" href="javascript:void(0);">
          <span class="glyphicon glyphicon-share" aria-hidden="true" style="color:#FFF";></span>&nbsp;Request Reassignment</a>
			</div>
      <div ng-if="data.canrequest_extension == 'yes'">
        <a class="btn btn-warning" href="javascript:void(0);">
         <span class="glyphicon glyphicon-calendar" aria-hidden="true" style="color:#FFF";></span>&nbsp;Request Extension</a>
      </div>
    </div>
  -->
         <!--i class="fa fa-trash-o fa-lg"></i-->


        
    <div ng-if="data.variables.length > 0" ng-init="c.variable_toggle = true">
      <button class="h4 options-btn" ng-click="c.variable_toggle = !c.variable_toggle" aria-expanded="{{c.variable_toggle}}" aria-controls="variables-toggle">
        <span style="font-size: 12px;" class="glyphicon" ng-class="c.variable_toggle ? 'glyphicon-chevron-down' : 'glyphicon-chevron-up'"></span>
        ${Options}
      </button>
      
      <div ng-if="c.variable_toggle" id="variables-toggle" aria-hidden="{{!c.variable_toggle}}">
        <hr role="presentation">
        <div class="m-b break-word" ng-repeat="variable in data.variables">
          <label class="m-n">{{variable.label}}</label>
          <div>{{variable.display_value}}</div>
        </div>
      </div>
    </div>
       
  </div>
  <div ng-if="data.agentPossible && !data.agent && options.pickup_msg" class="panel-footer">
    <div id="ticket_fields_footer" class="text-center text-muted" style="font-style: italic;" ng-bind-html="data.pickupMsg">
    </div>
  </div>

</div>
]]></template>
    </sp_widget>
</record_update>
